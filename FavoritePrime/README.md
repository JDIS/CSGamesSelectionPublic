# FavoritePrime

> My favorite prime is huge. HUUUUUUUGE.
> 
> .... Actually, throughout my life, my two greatest assets have been prime
> number stability and being, like, really smart. Crooked Intel also played
> these cards very hard and, as everyone knows, went down in flames. I went from
> VERY successful programmer, to top ringzer0 hacker to self-proclaimed crypto
> expert (on my first try). I think that would qualify as not smart, but
> genius.... and a very stable genius at that!

## Interception
Bonjour cher hacker. Grâce à un backdoor que nous avons inséré dans les CPUs
Intel, nous avons réussi à lire un peu de mémoire de la machine d'une importante
cible dont l'identité restera confidentielle.

Grâce au fabuleux travail que vous avez effectué sur `NotSoRegex`, nous avons
réutilisé votre engin pour trouver des informations intéressantes dans la
mémoire de la cible (nous avons effacé les parties où la mémoire semblait
corrompue):
```
# nuclear.sage
from sage.all import *

def encode(message_str):
    return int(message_str.encode('hex'), 16)

def decode(message_int):
    h = hex(message_int)[2:]
    if h[-1] == "L": h = h[:-1]
    if len(h) % 2 != 0: h = "0" + h
    return h.decode('hex')

# This is my favorite prime. Don't listen to the #FAKENEWS that I shouldn't reuse it
p = # MEMORY CORRUPTED #
q = random_prime(2**1024-1, False, 2**1023)
N = p * q

e = 65537
m = # MEMORY CORRUPTED #
assert(decode(encode(m)) == m)

c = pow(encode(m), e, N)

print("N: ")
print(N)
print("Encrypted message: ")
print(c)
# Signed: DT.

00000000: 7442 6840 5c57 9a9d 6e20 391f edc6 5592  tBh@\W..n 9...U.
00000010: e395 976c 2ce5 37c9 9c13 1dda 35da 734b  ...l,.7.....5.sK
00000020: 969e 92cc df59 7af4 e83e 7f4a 6631 0f0b  .....Yz..>.Jf1..
00000030: 25cb 4b56 eaa1 2ad2 526c 0a84 3e36 2ddf  %.KV..*.Rl..>6-.
00000040: f403 e41b 77f1 16e1 e5e3 afa9 9c0d 1856  ....w..........V
00000050: 5d57 2921 d37e 5e96 6539 ccf7 3e89 d605  ]W)!.~^.e9..>...
00000060: 807f 9f8e

Fox news daily

00000000: 6664 d44d 17ed 16c1 eb7c 017f 299a 3e26  fd.M.....|..).>&
00000010: 63c2 8460 ec53 8c1f 4899 af0c 711d 4edb  c..`.S..H...q.N.
00000020: c0b4 ee36 2c85 2899 4a3d 8a4b 5b81 3064  ...6,.(.J=.K[.0d
00000030: 6398 4d91 8287 5363 1331 3522 bab8 ba2d  c.M...Sc.15"...-
00000040: e023 bdb5 4dc0 070c a100 84c6 6227 6600  .#..M.......b'f.
00000050: a342 ab7f b2bb 31bf 06db b652 54ed 9914  .B....1....RT...
00000060: fb04 7172

> sage nuclear.sage
N: 
17706448071858715997773868470216333936058933886653647854927295173134050836774443423841927874963252080608820377281628638253961215357845615560316512974745068751624677757615237094077078224571079035567328657804538472495773111231849048584958727206111165274731415823872701914685373815085240281524630097962202158352225633569625831722906816349403266434463609317832674612403815236929656876489984140544370692778092817223242110494961246164652052146551717498818085377359257149344952734554441356456372248958980994006229399503997928250427203952885770523267798429994133057673945531714504504592857020413476304119434936357414343287393
Encrypted message: 
13465064760014633422617742189546880741773987933662305214468716910836156781916948557299700516771446369195097615275804766985567519106913039163792529696399969640475511796734490814880210528700857697353212179919199792683813062065809613357203337879703557230112014886432505111196088412476194458839743545094787054965439772556989524295391346870571340187994192866827098808522350474519778491282243965507063819634892372702869273561272491809686081718670274378457246068414098900438006356245281344239642622665691227211463065784482366760690453173065604116318457335516071851802336983560554509057679525066027782966812522728994487427484

> sage nuclear.sage
N:
16631733986721817765826826726605488838267280153881944006458966359814189840739837243967900872297261703335327451656082406080952463324796078253357128477586387027861684737444069206508854517965885317103598229295372675091404787307604815132987414532755953111566163805886631759940396070568288604103569400473269923083301605253608429385540153934293506727827021767448392751643304109725324560016062376671392404654777697614221820722620231528979622900621903197011665160813635377061247524379524893227051348964265177047854639712287645779438569675674769374528838597608461520705656113370615071628205481773964252700581983218261098749779
Encrypted message:
14752087698493463664147506599087588631160013640433862511407290153304577051088211828963854212563971475306161630129536219866854991679599315919721516637040821286975852390356640516172896599597462357294579017117183837874497754930405616700411895403233024980014874564092161539002909425609356864372775551278700209741166175809682052442412011613066597862900063528216363659737924515903023752552605271828022398857690556502350191736229298105612702671472473690801479146598404419323752956098299409440970959236395402042867585829052795543082469659093391078426334135684912546675148962641162175771594645737296899025352089340953515709186
```

## Solution
Nous recherchons une chaîne de caractères sous la forme `FLAG-[hexadecimal]`.
